{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "adfnachodev"
		},
		"AzureBlobStorage1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorage1'"
		},
		"AzureBlobStorage2_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorage2'"
		},
		"AzureBlob_Storage_cas_dus2324_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlob_Storage_cas_dus2324'"
		},
		"AzureDataLakeStorage1_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage1'"
		},
		"AzureDatabricks1_accessToken": {
			"type": "secureString",
			"metadata": "Secure string for 'accessToken' of 'AzureDatabricks1'"
		},
		"AzureSqlDatabase1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureSqlDatabase1'"
		},
		"SqlServer1_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'SqlServer1'"
		},
		"billonaris_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'billonaris'"
		},
		"blobStorageNE_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'blobStorageNE'"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://datalakecasdus.dfs.core.windows.net/"
		},
		"AzureDatabricks1_properties_typeProperties_existingClusterId": {
			"type": "string",
			"defaultValue": "0313-165249-hu61uwj1"
		},
		"billonaris_properties_typeProperties_server": {
			"type": "string",
			"defaultValue": "nachoserver.database.windows.net"
		},
		"billonaris_properties_typeProperties_database": {
			"type": "string",
			"defaultValue": "casdus2324"
		},
		"billonaris_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "administrador"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Fase_Landing_Completa')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "covid",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "tabla_covid",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "data",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "covid",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "tabla_data",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "grup_edat",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "tabla_grup_edat",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "provincies",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "grup_edat",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "tabla_provincies",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					},
					{
						"name": "sexe",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "provincies",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "tabla_sexe",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-03T15:37:05Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/tabla_covid')]",
				"[concat(variables('factoryId'), '/pipelines/tabla_data')]",
				"[concat(variables('factoryId'), '/pipelines/tabla_grup_edat')]",
				"[concat(variables('factoryId'), '/pipelines/tabla_provincies')]",
				"[concat(variables('factoryId'), '/pipelines/tabla_sexe')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Load and training COVID')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Load and training COVID",
						"type": "DatabricksNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Users/ignaciopaches@ieslluissimarro.org/Procesado_de_Datos_5.1"
						},
						"linkedServiceName": {
							"referenceName": "AzureDatabricks1",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Anteriores"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:08:14Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDatabricks1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LoadBeers')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "BeerLoading",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"additionalColumns": [
									{
										"name": "NOMFITXER",
										"value": "$$FILEPATH"
									}
								],
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ExcelXativaBEERNE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ExcelXATIVABeerCSVNE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Anteriores"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:08:14Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ExcelXativaBEERNE')]",
				"[concat(variables('factoryId'), '/datasets/ExcelXATIVABeerCSVNE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PipeLinesVentas')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dataFlowClients",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataFlowClients",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"sourceClients": {},
									"salidaClientes": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "dataFlowProveedores",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "dataFlowClients",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataFlowProveedores",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"sourceProveedores": {},
									"DestinoProveedores": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "dataFlowVentas",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "dataFlowProveedores",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataFlowVentas",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"sourceVentas": {},
									"salidaVentas": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "salidaVentasTotal",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "dataFlowVentas",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "salidaVentasTotal",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"salidaClientes": {},
									"salidaproveedores": {},
									"salidaVentas": {},
									"DestinoVentasTotal": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Anteriores"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:08:14Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dataFlowClients')]",
				"[concat(variables('factoryId'), '/dataflows/dataFlowProveedores')]",
				"[concat(variables('factoryId'), '/dataflows/dataFlowVentas')]",
				"[concat(variables('factoryId'), '/dataflows/salidaVentasTotal')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/cargar_tabla_casos_covid')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Cargar_tabla_covid_casoUso2324",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Fichero_casos_covid_2324",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "src_dst_sql_covid_23_24",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO 23-24"
				},
				"annotations": [],
				"lastPublishTime": "2024-03-11T18:18:01Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Fichero_casos_covid_2324')]",
				"[concat(variables('factoryId'), '/datasets/src_dst_sql_covid_23_24')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/extraerZip')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ExtraerZip_de_fichero_a_carpeta",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": false,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings",
									"compressionProperties": {
										"type": "ZipDeflateReadSettings",
										"preserveZipFileNameAsFolder": false
									}
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings",
									"copyBehavior": "PreserveHierarchy"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".csv"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CasDus_23_24_Zip_origen",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "dstLandingTablaCasosDus2324",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO 23-24"
				},
				"annotations": [],
				"lastPublishTime": "2024-03-11T19:19:48Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/CasDus_23_24_Zip_origen')]",
				"[concat(variables('factoryId'), '/datasets/dstLandingTablaCasosDus2324')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipe_csv_a_tabla2425')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "act_csv_a_tabla",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "datos_lliga",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TablaSQL2425",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/datos_lliga')]",
				"[concat(variables('factoryId'), '/datasets/TablaSQL2425')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/tabla_covid')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Fase1 tabla covid",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "src_covid",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "landing_Covid",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:08:14Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/src_covid')]",
				"[concat(variables('factoryId'), '/datasets/landing_Covid')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/tabla_data')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Fase1 tabla data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "src_data",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "landing_data",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:08:15Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/src_data')]",
				"[concat(variables('factoryId'), '/datasets/landing_data')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/tabla_grup_edat')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Fase1 tabla data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "src_grup_edat",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "landing_grup_edat",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:20:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/src_grup_edat')]",
				"[concat(variables('factoryId'), '/datasets/landing_grup_edat')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/tabla_provincies')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Fase1 tabla data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "src_grup_provincies",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "landing_provincies",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:20:57Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/src_grup_provincies')]",
				"[concat(variables('factoryId'), '/datasets/landing_provincies')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/tabla_sexe')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Fase1 tabla sexe",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "src_grup_sexe",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "landing_sexe",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Caso de USO"
				},
				"annotations": [],
				"lastPublishTime": "2023-03-27T16:32:16Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/src_grup_sexe')]",
				"[concat(variables('factoryId'), '/datasets/landing_sexe')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/BillionariesCSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Billionaire.csv",
						"container": "billionarieinput"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "Name",
						"type": "String"
					},
					{
						"name": "NetWorth",
						"type": "String"
					},
					{
						"name": "Country",
						"type": "String"
					},
					{
						"name": "Source",
						"type": "String"
					},
					{
						"name": "Rank",
						"type": "String"
					},
					{
						"name": "Age",
						"type": "String"
					},
					{
						"name": "Industry",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CasDus_23_24_Zip_origen')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Caso de Uso 23-24"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "datos_cas_dus_2324.zip",
						"container": "datoscasdus2324"
					},
					"columnDelimiter": ",",
					"compressionCodec": "ZipDeflate",
					"compressionLevel": "Optimal",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "PK\u0003\u0004\u0014\u0000\b\b\u0000\u0000�}dX\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000;\u0000\u0000\u0000Font de dades/casos_hosp_uci_def_sexo_edad_provres_full.csvprovincia_iso",
						"type": "String"
					},
					{
						"name": "sexo",
						"type": "String"
					},
					{
						"name": "grupo_edad",
						"type": "String"
					},
					{
						"name": "fecha",
						"type": "String"
					},
					{
						"name": "num_casos",
						"type": "String"
					},
					{
						"name": "num_hosp",
						"type": "String"
					},
					{
						"name": "num_uci",
						"type": "String"
					},
					{
						"name": "num_def",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EixidaClients')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Carpeta_Ventas"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "clientes.csv",
						"container": "ventas"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "Nombre completo",
						"type": "String"
					},
					{
						"name": "Fecha de nacimiento",
						"type": "String"
					},
					{
						"name": "Dirección",
						"type": "String"
					},
					{
						"name": "Localidad y Código postal",
						"type": "String"
					},
					{
						"name": "Teléfono",
						"type": "String"
					},
					{
						"name": "Correo electrónico",
						"type": "String"
					},
					{
						"name": "Fecha de alta",
						"type": "String"
					},
					{
						"name": "Grupo de clientes",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ExcelXATIVABeerCSVNE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "blobStorageNE",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "XativaBeerNE.csv",
						"container": "cervessesne"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": [
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/blobStorageNE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ExcelXativaBEERNE')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "blobStorageNE",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "EXT",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "XATIVA_Pivot_Beer.xls",
						"container": "cervessesne"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/blobStorageNE')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ExcelXativaBeer')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "EXT",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "XATIVA_Pivot_Beer.xls",
						"container": "cervesses"
					}
				},
				"schema": [
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					},
					{
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Fichero_casos_covid_2324')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlob_Storage_cas_dus2324",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Caso de Uso 23-24"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "casos_hosp_uci_def_sexo_edad_provres_full.csv",
						"folderPath": "Font de dades",
						"container": "landing2324"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "provincia_iso",
						"type": "String"
					},
					{
						"name": "sexo",
						"type": "String"
					},
					{
						"name": "grupo_edad",
						"type": "String"
					},
					{
						"name": "fecha",
						"type": "String"
					},
					{
						"name": "num_casos",
						"type": "String"
					},
					{
						"name": "num_hosp",
						"type": "String"
					},
					{
						"name": "num_uci",
						"type": "String"
					},
					{
						"name": "num_def",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlob_Storage_cas_dus2324')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Listado_Clientes')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Carpeta_Ventas"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Hoja1",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Lista-de-clientes-con-nombre-y-direccion.xlsx",
						"container": "ventas"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "Nombre completo",
						"type": "String"
					},
					{
						"name": "Fecha de nacimiento",
						"type": "String"
					},
					{
						"name": "Dirección",
						"type": "String"
					},
					{
						"name": "Localidad y Código postal",
						"type": "String"
					},
					{
						"name": "Teléfono",
						"type": "String"
					},
					{
						"name": "Correo electrónico",
						"type": "String"
					},
					{
						"name": "Fecha de alta",
						"type": "String"
					},
					{
						"name": "Grupo de clientes",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Listado_Proveedores')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage2",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Carpeta_Ventas"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Hoja1",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Listado-de-proveedores-y-contactos.xlsx",
						"container": "ventas"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "Proveedor",
						"type": "String"
					},
					{
						"name": "Contacto comercial",
						"type": "String"
					},
					{
						"name": "Email",
						"type": "String"
					},
					{
						"name": "Teléfono",
						"type": "String"
					},
					{
						"name": "Saldo pendiente",
						"type": "String"
					},
					{
						"name": "Fecha de última compra",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/LligaJSON')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "lliga.json",
						"container": "lliga"
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Registros_ventas')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Carpeta_Ventas"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Hoja1",
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Registros-de-ventas.xlsx",
						"container": "ventas"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "ID Cliente",
						"type": "String"
					},
					{
						"name": "Zona",
						"type": "String"
					},
					{
						"name": "País",
						"type": "String"
					},
					{
						"name": "Tipo de producto",
						"type": "String"
					},
					{
						"name": "Canal de venta",
						"type": "String"
					},
					{
						"name": "Prioridad",
						"type": "String"
					},
					{
						"name": "Fecha pedido",
						"type": "String"
					},
					{
						"name": "ID Pedido",
						"type": "String"
					},
					{
						"name": "Fecha envío",
						"type": "String"
					},
					{
						"name": "Unidades",
						"type": "String"
					},
					{
						"name": "Precio Unitario",
						"type": "String"
					},
					{
						"name": "Coste unitario",
						"type": "String"
					},
					{
						"name": "Importe venta total",
						"type": "String"
					},
					{
						"name": "Importe Coste total",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SalidaProveedores')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Carpeta_Ventas"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Proveedores.csv",
						"container": "ventas"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "Proveedor",
						"type": "String"
					},
					{
						"name": "Contacto comercial",
						"type": "String"
					},
					{
						"name": "Email",
						"type": "String"
					},
					{
						"name": "Teléfono",
						"type": "String"
					},
					{
						"name": "Saldo pendiente",
						"type": "String"
					},
					{
						"name": "Fecha de última compra",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SalidaVentasTotal')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "salidaVentas.csv",
						"container": "ventas"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TablaSQL2425')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "provincia_iso",
						"type": "nvarchar"
					},
					{
						"name": "sexo",
						"type": "nvarchar"
					},
					{
						"name": "grupo_edad",
						"type": "nvarchar"
					},
					{
						"name": "fecha",
						"type": "nvarchar"
					},
					{
						"name": "num_casos",
						"type": "nvarchar"
					},
					{
						"name": "num_hosp",
						"type": "nvarchar"
					},
					{
						"name": "num_uci",
						"type": "nvarchar"
					},
					{
						"name": "num_def",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "SRC_COVID"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/datos_lliga')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "datos_lliga.csv",
						"container": "lliga"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dstLandingTablaCasosDus2324')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlob_Storage_cas_dus2324",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Caso de Uso 23-24"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "landing2324"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlob_Storage_cas_dus2324')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/landing_Covid')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(formatDateTime(utcnow(), 'yyyyMMdd'),'_COVID.csv')",
							"type": "Expression"
						},
						"fileSystem": "landing"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/landing_data')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(formatDateTime(utcnow(), 'yyyyMMdd'),'_DATA.csv')",
							"type": "Expression"
						},
						"fileSystem": "landing"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/landing_grup_edat')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(formatDateTime(utcnow(), 'yyyyMMdd'),'_GRUP_EDAT.csv')",
							"type": "Expression"
						},
						"fileSystem": "landing"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/landing_provincies')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(formatDateTime(utcnow(), 'yyyyMMdd'),'_PROVINCIES.csv')",
							"type": "Expression"
						},
						"fileSystem": "landing"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/landing_sexe')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@concat(formatDateTime(utcnow(), 'yyyyMMdd'),'_SEXE.csv')",
							"type": "Expression"
						},
						"fileSystem": "landing"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/salidaVentas')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorage1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Carpeta_Ventas"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "Ventas.csv",
						"container": "ventas"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID Cliente",
						"type": "String"
					},
					{
						"name": "Zona",
						"type": "String"
					},
					{
						"name": "País",
						"type": "String"
					},
					{
						"name": "Tipo de producto",
						"type": "String"
					},
					{
						"name": "Canal de venta",
						"type": "String"
					},
					{
						"name": "Prioridad",
						"type": "String"
					},
					{
						"name": "Fecha pedido",
						"type": "String"
					},
					{
						"name": "ID Pedido",
						"type": "String"
					},
					{
						"name": "Fecha envío",
						"type": "String"
					},
					{
						"name": "Unidades",
						"type": "String"
					},
					{
						"name": "Precio Unitario",
						"type": "String"
					},
					{
						"name": "Coste unitario",
						"type": "String"
					},
					{
						"name": "Importe venta total",
						"type": "String"
					},
					{
						"name": "Importe Coste total",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/src_covid')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SRC_COVID"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/src_data')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SRC_DATA"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/src_dst_sql_covid_23_24')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "Caso de Uso 23-24"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SRC_COVID"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/src_grup_edat')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SRC_GRUP_EDAT"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/src_grup_provincies')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SRC_PROVINCIES"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/src_grup_sexe')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureSqlDatabase1",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "caso de uso"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "SRC_SEXE"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureSqlDatabase1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureBlobStorage1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorage1_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureBlobStorage2')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorage2_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureBlob_Storage_cas_dus2324')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlob_Storage_cas_dus2324_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataLakeStorage1_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDatabricks1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://adb-6363627019721782.2.azuredatabricks.net",
					"accessToken": {
						"type": "SecureString",
						"value": "[parameters('AzureDatabricks1_accessToken')]"
					},
					"existingClusterId": "[parameters('AzureDatabricks1_properties_typeProperties_existingClusterId')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlDatabase1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('AzureSqlDatabase1_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SqlServer1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('SqlServer1_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/billonaris')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Tabla billonaris de la primera pràctica de DataFactory",
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"server": "[parameters('billonaris_properties_typeProperties_server')]",
					"database": "[parameters('billonaris_properties_typeProperties_database')]",
					"encrypt": "mandatory",
					"trustServerCertificate": false,
					"authenticationType": "SQL",
					"userName": "[parameters('billonaris_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('billonaris_password')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/blobStorageNE')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('blobStorageNE_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataFlowClients')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Listado_Clientes",
								"type": "DatasetReference"
							},
							"name": "sourceClients"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "EixidaClients",
								"type": "DatasetReference"
							},
							"name": "salidaClientes"
						}
					],
					"transformations": [
						{
							"name": "tractamentData"
						},
						{
							"name": "tractamentEmail"
						},
						{
							"name": "tractamentDataAlta"
						}
					],
					"scriptLines": [
						"source(output(",
						"          ID as string,",
						"          {Nombre completo} as string,",
						"          {Fecha de nacimiento} as string,",
						"          {Dirección} as string,",
						"          {Localidad y Código postal} as string,",
						"          {Teléfono} as string,",
						"          {Correo electrónico} as string,",
						"          {Fecha de alta} as string,",
						"          {Grupo de clientes} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     limit: 100,",
						"     ignoreNoFilesFound: false) ~> sourceClients",
						"sourceClients derive({Fecha de nacimiento} = iif(regexMatch({Fecha de nacimiento}, '^[0-9]{4}-[01][0-9]-[0123][0-9]$'),{Fecha de nacimiento}, toString(null()))) ~> tractamentData",
						"tractamentData derive({Correo electrónico} = iif(regexMatch( translate({Correo electrónico}, ',', '.'), '[^@]+@[^@]+'),{Correo electrónico},translate({Correo electrónico}, '-', '@'))) ~> tractamentEmail",
						"tractamentEmail derive({Fecha de alta} = iif(regexMatch({Fecha de alta}, '^[0-9]{4}-[01][0-9]-[0123][0-9]T[0-9]{2}:[0-9]{2}:[0-9]{2}'),{Fecha de alta}, toString(null()))) ~> tractamentDataAlta",
						"tractamentDataAlta sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          ID as string,",
						"          {Nombre completo} as string,",
						"          {Fecha de nacimiento} as string,",
						"          {Dirección} as string,",
						"          {Localidad y Código postal} as string,",
						"          {Teléfono} as string,",
						"          {Correo electrónico} as string,",
						"          {Fecha de alta} as string,",
						"          {Grupo de clientes} as string",
						"     ),",
						"     partitionFileNames:['clientes.csv'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> salidaClientes"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Listado_Clientes')]",
				"[concat(variables('factoryId'), '/datasets/EixidaClients')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataFlowProveedores')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Listado_Proveedores",
								"type": "DatasetReference"
							},
							"name": "sourceProveedores"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "SalidaProveedores",
								"type": "DatasetReference"
							},
							"name": "DestinoProveedores"
						}
					],
					"transformations": [
						{
							"name": "TramientoDatos"
						}
					],
					"scriptLines": [
						"source(output(",
						"          ID as string,",
						"          Proveedor as string,",
						"          {Contacto comercial} as string,",
						"          Email as string,",
						"          {Teléfono} as string,",
						"          {Saldo pendiente} as string,",
						"          {Fecha de última compra} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> sourceProveedores",
						"sourceProveedores derive(Email = iif(regexMatch( translate(Email, ',', '.'), '[^@]+@[^@]+'),Email,translate(Email, '-', '@'))) ~> TramientoDatos",
						"TramientoDatos sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          ID as string,",
						"          Proveedor as string,",
						"          {Contacto comercial} as string,",
						"          Email as string,",
						"          {Teléfono} as string,",
						"          {Saldo pendiente} as string,",
						"          {Fecha de última compra} as string",
						"     ),",
						"     partitionFileNames:['Proveedores.csv'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> DestinoProveedores"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Listado_Proveedores')]",
				"[concat(variables('factoryId'), '/datasets/SalidaProveedores')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataFlowVentas')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Registros_ventas",
								"type": "DatasetReference"
							},
							"name": "sourceVentas"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "salidaVentas",
								"type": "DatasetReference"
							},
							"name": "salidaVentas"
						}
					],
					"transformations": [],
					"scriptLines": [
						"source(output(",
						"          {ID Cliente} as string,",
						"          Zona as string,",
						"          {País} as string,",
						"          {Tipo de producto} as string,",
						"          {Canal de venta} as string,",
						"          Prioridad as string,",
						"          {Fecha pedido} as string,",
						"          {ID Pedido} as string,",
						"          {Fecha envío} as string,",
						"          Unidades as string,",
						"          {Precio Unitario} as string,",
						"          {Coste unitario} as string,",
						"          {Importe venta total} as string,",
						"          {Importe Coste total} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> sourceVentas",
						"sourceVentas sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {ID Cliente} as string,",
						"          Zona as string,",
						"          {País} as string,",
						"          {Tipo de producto} as string,",
						"          {Canal de venta} as string,",
						"          Prioridad as string,",
						"          {Fecha pedido} as string,",
						"          {ID Pedido} as string,",
						"          {Fecha envío} as string,",
						"          Unidades as string,",
						"          {Precio Unitario} as string,",
						"          {Coste unitario} as string,",
						"          {Importe venta total} as string,",
						"          {Importe Coste total} as string",
						"     ),",
						"     partitionFileNames:['Ventas.csv'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> salidaVentas"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Registros_ventas')]",
				"[concat(variables('factoryId'), '/datasets/salidaVentas')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/salidaVentasTotal')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "EixidaClients",
								"type": "DatasetReference"
							},
							"name": "salidaClientes"
						},
						{
							"dataset": {
								"referenceName": "SalidaProveedores",
								"type": "DatasetReference"
							},
							"name": "salidaproveedores"
						},
						{
							"dataset": {
								"referenceName": "salidaVentas",
								"type": "DatasetReference"
							},
							"name": "salidaVentas"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "SalidaVentasTotal",
								"type": "DatasetReference"
							},
							"name": "DestinoVentasTotal"
						}
					],
					"transformations": [
						{
							"name": "join1"
						},
						{
							"name": "join2"
						},
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          ID as string,",
						"          {Nombre completo} as string,",
						"          {Fecha de nacimiento} as string,",
						"          {Dirección} as string,",
						"          {Localidad y Código postal} as string,",
						"          {Teléfono} as string,",
						"          {Correo electrónico} as string,",
						"          {Fecha de alta} as string,",
						"          {Grupo de clientes} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> salidaClientes",
						"source(output(",
						"          ID as string,",
						"          Proveedor as string,",
						"          {Contacto comercial} as string,",
						"          Email as string,",
						"          {Teléfono} as string,",
						"          {Saldo pendiente} as string,",
						"          {Fecha de última compra} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> salidaproveedores",
						"source(output(",
						"          {ID Cliente} as string,",
						"          Zona as string,",
						"          {País} as string,",
						"          {Tipo de producto} as string,",
						"          {Canal de venta} as string,",
						"          Prioridad as string,",
						"          {Fecha pedido} as string,",
						"          {ID Pedido} as string,",
						"          {Fecha envío} as string,",
						"          Unidades as string,",
						"          {Precio Unitario} as string,",
						"          {Coste unitario} as string,",
						"          {Importe venta total} as string,",
						"          {Importe Coste total} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> salidaVentas",
						"salidaClientes, salidaVentas join(ID == {ID Cliente},",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1, salidaproveedores join({ID Pedido} == salidaproveedores@ID,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join2",
						"join2 select(mapColumn(",
						"          ID = salidaClientes@ID,",
						"          {Nombre completo},",
						"          {Fecha de nacimiento},",
						"          {Dirección},",
						"          {Localidad y Código postal},",
						"          {Teléfono} = salidaClientes@{Teléfono},",
						"          {Correo electrónico},",
						"          {Fecha de alta},",
						"          {Grupo de clientes},",
						"          {ID Cliente},",
						"          Zona,",
						"          {País},",
						"          {Tipo de producto},",
						"          {Canal de venta},",
						"          Prioridad,",
						"          {Fecha pedido},",
						"          {ID Pedido},",
						"          {Fecha envío},",
						"          Unidades,",
						"          {Precio Unitario},",
						"          {Coste unitario},",
						"          {Importe venta total},",
						"          {Importe Coste total},",
						"          ID = salidaproveedores@ID,",
						"          Proveedor,",
						"          {Contacto comercial},",
						"          Email,",
						"          {Teléfono} = salidaproveedores@{Teléfono},",
						"          {Saldo pendiente},",
						"          {Fecha de última compra}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     partitionFileNames:['SalidaVentasMAL.csv'],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> DestinoVentasTotal"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/EixidaClients')]",
				"[concat(variables('factoryId'), '/datasets/SalidaProveedores')]",
				"[concat(variables('factoryId'), '/datasets/salidaVentas')]",
				"[concat(variables('factoryId'), '/datasets/SalidaVentasTotal')]"
			]
		}
	]
}